Vtiger_Detail_Js("VTEReports_Detail_Js",{},{advanceFilterInstance:!1,detailViewContentHolder:!1,HeaderContentsHolder:!1,getContentHolder:function(){0==this.detailViewContentHolder&&(this.detailViewContentHolder=jQuery("div.contentsDiv"));return this.detailViewContentHolder},getHeaderContentsHolder:function(){0==this.HeaderContentsHolder&&(this.HeaderContentsHolder=jQuery("div.reportsDetailHeader "));return this.HeaderContentsHolder},calculateValues:function(){for(var d="",u="account_id contactid contact_id product_id parent_id campaignid potential_id assigned_user_id1 quote_id accountname salesorder_id vendor_id time_start time_end lastname".split(" "),
c=vt_getElementsByName("tr","conditionColumn"),g=[],q=JSON.parse(document.getElementById("sel_fields").value),a=0;a<c.length;a++){var p=c[a].getAttribute("id"),b=p.split("_"),p=b[1],b=b[2];ctype="0"!=p?"f":"g";var l=ctype+"col"+b,e=getObj(l),t=e.value,h=e.selectedIndex,k=e.options[h].text;if("none"!=e.options[h].value){var f=ctype+"op"+b,e=getObj(f),e=e.value,h=ctype+"val"+b,n=getObj(h),m=n.value,w=ctype+"val_ext"+b,v=getObj(w);v&&(extendedValue=v.value);var n=ctype+"con"+b,r=getObj(n),n="";r&&(n=
r.value);f=t.split(":");r=document.getElementById("std_filter_columns").value;if(-1<("undefined"!=typeof r&&""!=r?r.split("<%jsstdjs%>"):[]).indexOf(t)){if("custom"==e&&!emptyCheckVte("jscal_field_sdate_val_"+b," Column ","text")||"custom"==e&&!emptyCheckVte("jscal_field_edate_val_"+b," Column ","text"))return!1;"custom"==e?(k=document.getElementById("jscal_field_sdate_val_"+b).value,l=document.getElementById("jscal_field_edate_val_"+b).value):(k=document.getElementById("jscal_field_sdate"+b).value,
l=document.getElementById("jscal_field_edate"+b).value);m=k+"<;@STDV@;>"+l}else if("currency_id"==f[1]){if(!emptyCheckVte(l," Column ","text"))return!1}else if(-1==u.indexOf(f[3])){if("T"==f[4]){if(l=m.split(" "),!re_dateValidate(l[0],k+" (Current User Date Time Format)","OTH")||1<l.length&&!re_patternValidate(l[1],k+" (Time)","TIMESECONDS"))return!1}else if("D"==f[4]){if(!dateValidate(h,k+" (Current User Date Format)","OTH")||v&&!dateValidate(w,k+" (Current User Date Format)","OTH"))return!1}else if("I"==
f[4]){if(!intValidate(h,k+" (Integer Criteria)"+a))return!1}else if("N"==f[4]){if(!numValidate(h,k+" (Number) ","any",!0))return!1}else if("E"==f[4]&&!patternValidate(h,k+" (Email Id)","EMAIL"))return!1;q[t]&&(m=("e"==e||"n"==e?jQuery("#s_fval"+b):jQuery("#fval"+b)).val())}v&&null!=extendedValue&&""!=extendedValue&&(m=m+","+extendedValue);g[b]={groupid:p,columnname:t,comparator:e,value:m,column_condition:n}}}a=JSON.stringify(g);d+="advft_criteria="+a;p=vt_getElementsByName("div","conditionGroup");
c=[];for(a=0;a<p.length;a++)g=p[a].getAttribute("id").split("_")[1],q=getObj("gpcon"+g),b="",q&&(b=q.value),c[g]={groupcondition:b};a=JSON.stringify(c);d+="&advft_criteria_groups="+a;c=vt_getElementsByName("tr","groupconditionColumn");g=[];for(a=0;a<c.length;a++)if(p=c[a].getAttribute("id"),b=p.split("_"),p=b[1],b=b[2],ctype="0"!=p?"f":"g",l=ctype+"groupcol"+b,e=getObj(l),t=e.value,h=e.selectedIndex,k=e.options[h].text,"none"!=e.options[h].value){f=ctype+"groupop"+b;e=getObj(f);e=e.value;h=ctype+
"groupval"+b;n=getObj(h);m=n.value;n=ctype+"groupcon"+b;r=getObj(n);n="";r&&(n=r.value);if(1<c.length&&(!emptyCheckVte(l," Column ","text")||!emptyCheckVte(f,k+" Option","text")))return!1;f=t.split(":");if(-1==u.indexOf(f[3]))if("T"==f[4]){if(l=m.split(" "),!re_dateValidate(l[0],k+" (Current User Date Time Format)","OTH")||1<l.length&&!re_patternValidate(l[1],k+" (Time)","TIMESECONDS"))return!1}else if("D"==f[4]){if(!dateValidate(h,k+" (Current User Date Format)","OTH")||v&&!dateValidate(w,k+" (Current User Date Format)",
"OTH"))return!1}else if("I"==f[4]){if(!intValidate(h,k+" (Integer Criteria)"+a))return!1}else if("N"==f[4]){if(!numValidate(h,k+" (Number) ","any",!0))return!1}else if("E"==f[4]&&!patternValidate(h,k+" (Email Id)","EMAIL"))return!1;"C"==f[4]&&("1"==m?m=getObj(h).value="yes":"0"==m&&(m=getObj(h).value="no"));v&&null!=extendedValue&&""!=extendedValue&&(m=m+","+extendedValue);g[b]={groupid:p,columnname:t,comparator:e,value:m,column_condition:n}}return d+("&groupft_criteria="+g)},registerSaveOrGenerateReportEvent:function(){var d=
this;jQuery(".generateReport").on("click",function(u){var c=d.calculateValues();if(!1!==c){var g=c.split("&"),c=g[0].split("=")[1],q=g[1].split("=")[1],g=g[2].split("=")[1];d.getRecordId();u=jQuery(u.currentTarget).data("mode");jQuery("#advft_criteria").val(c);jQuery("#advft_criteria_groups").val(q);jQuery("#groupft_criteria").val(g);jQuery("#currentMode").val(u);jQuery("#detailView").submit()}return!1});jQuery(".addWidget").on("click",function(d){var c=jQuery.Deferred(),g=jQuery(this);d=jQuery(this).data("type");
var q=jQuery.progressIndicator({position:"html",blockInfo:{enabled:!0}}),a=jQuery("#recordId").val();AppConnector.request("index.php?module=VTEReports&action=IndexAjax&mode=addWidget&record="+a+"&type="+d).then(function(c){Vtiger_Helper_Js.showMessage({text:c.result.message});g.hide();q.progressIndicator({mode:"hide"})},function(a){c.reject(a)});return c.promise()});jQuery(".addWidgetList").live("click",function(d){var c=jQuery(this),g=jQuery.Deferred(),q=jQuery.progressIndicator({position:"html",
blockInfo:{enabled:!0}});d=jQuery("#recordId").val();var a=c.data("mode");AppConnector.request("index.php?module=VTEReports&action=IndexAjax&mode=addwidgetList&record="+d+"&amethod="+a).then(function(a){Vtiger_Helper_Js.showMessage({text:a.result.message});"ADD"==a.result.mode?c.data("mode","removewidgetList"):c.data("mode","addwidgetList");c.val(a.result.html);c.html("<strong>"+a.result.html+"</strong>");q.progressIndicator({mode:"hide"})},function(a){g.reject(a)});return g.promise()})},registerEventsForActions:function(){jQuery("#XLSExport").click(function(d){d=
jQuery(d.currentTarget).data("href");window.location.href=d});jQuery("#CSVExport").click(function(d){d=jQuery(d.currentTarget).data("href");window.location.href=d})},registerEvents:function(){this._super();this.registerEventsForActions();this.registerSaveOrGenerateReportEvent();var d=this.getContentHolder();this.advanceFilterInstance=Vtiger_AdvanceFilter_Js.getInstance(jQuery(".filterContainer",d))}});